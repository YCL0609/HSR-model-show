<!DOCTYPE html>
<html>

<head>
	<title>3D模型查看</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<link rel="preload" as="script" href="js/3d/three.js/libs/ammo.wasm.js">
	<link rel="preload" as="script" href="js/3d/es-module-shims.js">
	<link type="text/css" rel="stylesheet" href="css/3d.css">
	<link href="favicon.ico" rel="shortcut icon">
	<script src="js/baidu.js"></script>
	<!-- <script src="outside/function.js" defer></script> -->
	<script src="//www.ycl.cool/js/function.js" defer></script>
	<script rel="preload" src="js/3d/es-module-shims.js" defer></script>
	<script src="js/3d/three.js/libs/ammo.wasm.js" defer></script>
	<script>
		// 判断是否为Webkit用户
		let isSafari = /WebKit/i.test(navigator.userAgent) && !/(Chrome|android)/i.test(navigator.userAgent);
		if (isSafari) {
			alert('由于Webkit内核对于WebGL兼容性有限, 页面可能出现未知渲染问题。\nDue to the limited compatibility of the Webkit kernel for WebGL, pages may have unknown rendering issues.')
		}

		function Gotovmd(cho) {
			let id = getUrlParams('id');
			let other = getUrlParams('other');
			if (!other) {
				window.location.href = "3d.html?id=" + id + "&vmd=" + cho;
			} else {
				window.location.href = "3d.html?id=" + id + "&other=1" + "&vmd=" + cho;
			}
		}
	</script>
</head>

<body>
	<script type="importmap">{
		"imports": {
			"WebUI": "./js/3d/UI.js",
			"three": "./js/3d/three.js/three.module.min.js",
			"three/": "./js/3d/three.js/"
		}
	}</script>
	<script type="module" src="js/3d/3d.js"></script>
	<!-- 加载进度 -->
	<div id="info">
		<div id="info-main">
			<div id="main">
				<a>主进度:</a>
				<a id="text0" class="text">(1/4)加载three.js...</a><br>
				<a>Main process:</a>
				<a id="texte0" class="text">(1/4)Loading three.js...</a>
				<div class="progress">
					<div id="progress0" class="progress-inside" style="width: 0%"></div>
				</div>
			</div>
			<div id="module" style="display: none">
				<a id="text1" class="text">主模型:</a><br>
				<a id="texte1" class="text">Character model:</a>
				<div class="progress">
					<div id="progress1" class="progress-inside" style="width: 0%"></div>
				</div>
			</div>
			<div id="background" style="display: none">
				<a>场景模型:</a>
				<a id="text2" class="text"></a><br>
				<a>Scene model:</a>
				<a id="texte2" class="text"></a>
				<div class="progress">
					<div id="progress2" class="progress-inside" style="width: 0%"></div>
				</div>
			</div>
			<div id="skybox" style="display: none;margin-bottom: 10px">
				<a>天空盒:</a>
				<a id="text3" class="text">加载材质...</a><br>
				<a>Skybox:</a>
				<a id="texte3" class="text">Loading texture...</a>
				<div class="progress">
					<div id="progress3" class="progress-inside" style="width: 0%"></div>
				</div>
			</div>
			<button id="start" style="display: none"></button>
		</div>
	</div>
	<!-- 使用本地vmd文件 -->
	<div id="localVMD">
		<div id="localVMD-main">
			<a style="font-weight: bolder;font-size: large">test</a><br>
			<input type="file" id="vmdInput" accept=".vmd" />
			<input type="file" id="mp3Input" accept=".mp3" />
		</div>
	</div>
	<!-- vmd动作选择 -->
	<div id="VMDList">
		<a style="color: #fff">可用动作列表</a>
		<a style="color: #fff;font-size: 10px">Available actions</a>
		<hr>
		<a style="cursor: pointer;text-decoration: underline" onclick="Gotovmd(1)">极乐净土</a><br>
		<a style="cursor: pointer;text-decoration: underline" onclick="Gotovmd(2)">彩虹节拍</a><br>
		<a style="cursor: pointera;text-decoration: underline" onclick="Gotovmd(3)">Good Time</a><br>
		<hr>
		<button onclick="document.getElementById('VMDList').style.left='-100px'">关闭(Close)</button>
	</div>
	<!-- three.js -->
	<b id="three">此页使用<a href="https://threejs.org/" style="color: aqua;">three.js</a>作为webgl渲染引擎<br>
	</b>
	<div id="error"></div>
</body>

</html>